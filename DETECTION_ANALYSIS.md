# 瞬き検出の誤検出問題と改善策

## 問題の原因

首を振るなどの動作で瞬きが誤検出される主な原因は以下の通りです。

### 1. 顔の向きの変化による目の見え方の変化
首を振ると、カメラに対する目の角度が変わり、MediaPipeが検出する目の開閉度（eyeBlinkLeft/Right）の値が変動します。特に横を向くと、片方の目が隠れたり、目の形状が変わって見えるため、瞬きと誤認識されます。

### 2. フレーム間での顔検出の不安定性
急激な動きにより、一時的に顔検出が失われたり、ランドマークの位置が大きく変動することで、目の開閉スコアが急変します。

### 3. 現在の検出ロジックの単純さ
現在の実装では、eyeBlinkスコアの平滑化のみを行っており、顔の向きや動きの速度を考慮していません。

## 改善策

### 1. 両目の同期チェック
真の瞬きでは、通常両目がほぼ同時に閉じます。片目だけが閉じている場合は、顔の向きの変化による誤検出の可能性が高いです。

### 2. 顔の向き（ヘッドポーズ）の監視
MediaPipeのface landmarksから顔の向き（pitch, yaw, roll）を推定し、顔が大きく動いている間は検出を一時停止します。

### 3. 瞬きの持続時間チェック
真の瞬きは通常100-400ms程度です。極端に短い（1フレーム）または長い変化は誤検出の可能性が高いです。

### 4. 顔検出の安定性チェック
顔のランドマークが大きく移動している場合（急激な動き）は、検出を一時停止します。

### 5. 閾値の動的調整
ユーザーごとの目の形状や環境に応じて、閾値を動的に調整します。

